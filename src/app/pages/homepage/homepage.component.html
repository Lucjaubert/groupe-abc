<div class="homepage-wrapper pt-6" *ngIf="acf">
  <section id="hero"
           class="hero-section"
           (mouseenter)="pauseAutoplay()"
           (mouseleave)="resumeAutoplay()"
           tabindex="0"
           role="region"
           aria-label="Carrousel d'images – section Héro"
           (keydown)="onKeydown($event)"
           (pointerdown)="onPointerDown($event)"
           (pointerup)="onPointerUp($event)">

    <div class="hero-bg" #heroBg>
      <div class="hero-layer"
           #heroLayer
           *ngFor="let sld of heroSlides; let i = index; trackBy: trackByIndex"
           [class.active]="i === heroIndex"
           [style.backgroundImage]="'url(' + (s(sld?.bg) || '/assets/fallbacks/hero-placeholder.jpg') + ')'">
      </div>
    </div>

    <div class="hero-overlay pb-10">
      <div class="hero-content mt-5 mt-lg-0" aria-live="polite">
        <h1 class="hero-title" #heroTitle data-wg-notranslate>
          {{ currentSlide?.title }}
        </h1>
        <p class="hero-subtitle" #heroSubtitle data-wg-notranslate>
          {{ currentSlide?.subtitle }}
        </p>
      </div>

      <div class="hero-dots" *ngIf="heroSlides.length > 1">
        <button *ngFor="let _ of heroSlides; let i = index; trackBy: trackByIndex"
                type="button"
                class="hero-dot"
                [class.active]="i === heroIndex"
                [attr.aria-label]="'Aller au slide ' + (i + 1)"
                [attr.aria-current]="i === heroIndex ? 'true' : null"
                (click)="goTo(i)">
        </button>
      </div>
    </div>
  </section>

  <!-- Key figures -->
  <section id="key-figures" class="key-figures" *ngIf="keyFigures.length">
    <ul [style.--n]="maxValueCh">
      <li *ngFor="let fig of keyFigures; let i = index; trackBy: trackByIndex"
          #kfItem
          [attr.data-index]="i"
          [ngStyle]="{ '--value-w': (fig.digits + 'ch') }"
          [ngClass]="{ col1: i < 5, col2: i >= 5 && i < 9, col3: i >= 9, 'grp-sep': i === 5 || i === 9 }">

        <span class="value" data-wg-notranslate>{{ fig.display || '\u00A0' }}</span>
        <span class="label" data-wg-notranslate>{{ fig.typed }}</span>
      </li>
    </ul>
  </section>

  <!-- ===== Identity : Qui / Où ===== -->
  <section id="identity" class="identity" *ngIf="identity?.whoTitle || identity?.whereTitle">
    <div class="identity-grid">

      <!-- Qui ? (colonne gauche) -->
      <article class="who py-5 py-lg-5">
        <h2 class="block-title">{{ identity.whoTitle }}</h2>

        <div class="who-text mt-5" [innerHTML]="identity.whoHtml"></div>

        <div class="who-actions">
          <button
            class="cta-btn mt-5"
            type="button"
            routerLink="/expert-immobilier-reseau-national">
            <span class="cta-label">Lire la suite</span>
            <span class="cta-plus" aria-hidden="true">
              <svg viewBox="0 0 24 24" class="icon-plus">
                <path d="M12 5v14M5 12h14" />
              </svg>
            </span>
          </button>
        </div>
      </article>

      <!-- Où ? (colonne droite) -->
      <div class="where py-5 py-lg-5" [class.open]="whereOpen">
        <div class="where-head">
          <h2 class="block-title">{{ identity.whereTitle }}</h2>

          <button class="where-toggle"
                  type="button"
                  [attr.aria-expanded]="whereOpen"
                  aria-controls="where-body"
                  (click)="toggleWhere()">
            <svg class="chevron" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>

        <div id="where-body" class="where-body">
          <!-- Carte -->
          <div class="where-panel panel-map" [attr.aria-hidden]="whereOpen">
            <div class="where-map py-6 px-3">
              <img
                [appImgFast]="s(identity.whereMap)"
                [placeholder]="'/assets/fallbacks/image-placeholder.svg'"
                loading="lazy"
                decoding="async"
                alt="Carte des zones d'intervention du Groupe ABC"
              />
            </div>
          </div>

          <!-- Liste -->
          <ul class="where-panel panel-list mt-4 d-flex align-items-start" [attr.aria-hidden]="!whereOpen">
            <li *ngFor="let item of whereItems; trackBy: trackByIndex">
              <a
                class="where-link"
                href=""
                (click)="$event.preventDefault(); openRegion(item)">{{ item }}</a>
            </li>
          </ul>
        </div>
      </div>

    </div>
  </section>

  <!-- ============ QUOI / COMMENT / TÉLÉCHARGER ============ -->
  <section class="wh mt-lg-5" *ngIf="whatHow">
    <div class="wh-grid">
      <div class="wh-left">
        <article class="what py-5 py-lg-5">
          <h2 class="block-title">{{ whatHow.whatTitle }}</h2>

          <ul class="dash-list mt-5">
            <li *ngFor="let item of whatHow.whatItems">{{ item }}</li>
          </ul>

          <div class="wh-actions">
            <button type="button" class="cta-btn" routerLink="/methodes-evaluation-immobiliere">
              <span class="cta-label">Lire la suite</span>
              <span class="cta-plus" aria-hidden="true">
                <svg viewBox="0 0 24 24" class="icon-plus">
                  <path d="M12 5v14M5 12h14" />
                </svg>
              </span>
            </button>
          </div>
        </article>

        <!-- Download -->
        <article class="download py-5 py-lg-5">
          <a class="dl-link"
             [class.disabled]="!presentation.file"
             [attr.href]="presentation.file || null"
             [attr.tabindex]="presentation.file ? null : '-1'"
             [attr.aria-disabled]="!presentation.file ? 'true' : null">

            <div class="dl-text">
              <div class="dl-line dl-line--hard">
                Télécharger<br>
                la présentation<br>
                du <span class="dl-accent">Groupe ABC</span>
              </div>
            </div>

            <img class="dl-icon-img"
                 src="assets/icons/download.webp"
                 alt="Télécharger"
                 width="48" height="56" loading="lazy">
          </a>
        </article>
      </div>

      <!-- Colonne droite : Comment + CTA -->
      <div class="wh-right">
        <article class="how">
          <h2 class="block-title">{{ whatHow.howTitle }}</h2>

          <ul class="dash-list mt-5">
            <li *ngFor="let item of whatHow.howItems">{{ item }}</li>
          </ul>
        </article>

        <div class="wh-actions">
          <button type="button" class="cta-btn" routerLink="/expertise-immobiliere-services">
            <span class="cta-label">Lire la suite</span>
            <span class="cta-plus" aria-hidden="true">
              <svg viewBox="0 0 24 24" class="icon-plus">
                <path d="M12 5v14M5 12h14" />
              </svg>
            </span>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== Contextes d’intervention ===== -->
  <section class="contexts" aria-labelledby="contexts-title" *ngIf="contexts?.items?.length">
    <div class="contexts-bg" aria-hidden="true"></div>

    <div class="contexts-inner px-0">
      <div class="contexts-head">
        <h2 id="contexts-title" class="contexts-title mt-lg-0 mt-8">{{ contexts?.title }}</h2>

        <div class="contexts-actions mt-6 mt-lg-0 mb-5 mb-lg-0">
          <button
            type="button"
            class="cta-btn"
            routerLink="/expertise-immobiliere-services">
            <span class="cta-label">Plus d'infos</span>
            <span class="cta-plus" aria-hidden="true">
              <svg viewBox="0 0 24 24" class="icon-plus">
                <path d="M12 5v14M5 12h14" />
              </svg>
            </span>
          </button>
        </div>
      </div>

      <ul class="contexts-grid px-0 pb-4" role="list">
        <li class="ctx-item mt-lg-0 mt-5" *ngFor="let it of contexts?.items; let i = index; trackBy: trackByIndex">
          <div class="ctx-icon" role="img" [attr.aria-label]="it.label || ('Contexte ' + (i+1))">
            <img class="ctx-img" [src]="s(it?.icon)" alt="" loading="lazy">
          </div>
          <div class="ctx-label mt-4" [appAlignFirstWord]="it.label"></div>
        </li>
      </ul>
    </div>
  </section>

  <!-- ===== Nos clients ===== -->
  <section class="clients" aria-labelledby="clients-title" *ngIf="clients?.items?.length">
    <div class="clients-bg" aria-hidden="true"></div>

    <div class="clients-inner px-0">
      <div class="row align-items-start clients-row gx-0">
        <div class="col-lg-auto clients-left pe-lg-5">
          <img
            class="clients-icon d-block"
            [src]="s(clients?.icon)"
            alt=""
            aria-hidden="true"
            loading="lazy"
            decoding="async"
            fetchpriority="low"
          />
          <h2 id="clients-title" class="clients-title">{{ clients?.title }}</h2>
        </div>

        <div class="col-lg clients-right">
          <div class="col-lg clients-right">
            <ul class="dash-list clients-list list-unstyled m-0" role="list">
              <li *ngFor="let item of clients?.items; trackBy: trackByIndex">{{ item }}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== Team ===== -->
  <section id="team" class="team" *ngIf="teamPages.length">
    <div class="team-inner px-0">
      <h2 class="team-title" #teamTitle>
        <span class="line1">{{ teamTitleLine1 }}</span>
        <span class="line2">{{ teamTitleLine2 }}</span>
      </h2>

      <div class="team-grid" aria-live="polite">
        <article
          class="member-card"
          #teamCard
          *ngFor="let m of teamPages[teamPageIndex]; trackBy: trackByIndex">

          <div class="photo-tile">
            <img
              [src]="s(m?.photo) || defaultPortrait"
              [attr.alt]="'Portrait de ' + (m?.nameFirst || '') + ' ' + (m?.nameLast || '')"
              loading="lazy"
              decoding="async"
              (error)="$any($event.target).src = defaultPortrait">
          </div>

          <div class="member-text pt-3">
            <div class="member-area">{{ m.area }}</div>
            <div class="member-name">
              <div class="first">{{ m.nameFirst }}</div>
              <div class="last">{{ m.nameLast }}</div>
            </div>
            <div class="member-job" [innerHTML]="m.jobHtml"></div>
          </div>
        </article>
      </div>

      <div class="team-bottom">
        <div class="team-dots" role="tablist" aria-label="Profils de l’équipe">
          <button
            *ngFor="let _ of teamPages; let i = index; trackBy: trackByIndex"
            type="button"
            class="team-dot"
            [class.active]="i === teamPageIndex"
            [attr.aria-label]="'Aller aux profils ' + (i*2+1) + '–' + (i*2+2)"
            [attr.aria-selected]="i === teamPageIndex ? 'true' : 'false'"
            role="tab"
            (click)="goTeamTo(i)">
          </button>
        </div>

        <div class="team-cta">
          <button type="button" class="cta-btn" [routerLink]="['/experts-immobiliers-agrees']">
            <span class="cta-label">Voir nos équipes</span>
            <span class="cta-plus" aria-hidden="true">
              <svg viewBox="0 0 24 24" class="icon-plus"><path d="M12 5v14M5 12h14"/></svg>
            </span>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- ===================== NEWS ===================== -->
  <section class="news" *ngIf="news"
           style="--news-side-right:40px; --news-side-gap:83px">
    <div class="news-bg" aria-hidden="true"></div>

    <div class="news-inner px-0">
      <h2 class="news-title">{{ news.title }}</h2>

      <div class="news-row">
        <div class="news-grid">
          <article class="news-card"
                   *ngFor="let it of news?.items; let i = index; trackBy: trackByIndex"
                   [ngClass]="themeClass(it.themeKey)">
            <span class="news-card-bg" aria-hidden="true"></span>

            <header class="news-head">
              <img *ngIf="it.logo"
                   class="news-logo"
                   [src]="s(it.logo)"
                   alt=""
                   aria-hidden="true" />
              <div class="news-meta">
                <div class="news-firm">{{ it.firm }}</div>
                <div class="news-author">{{ it.authorDate }}</div>
              </div>
            </header>

            <h4 class="news-item-title">{{ it.title }}</h4>
            <div class="news-body" [innerHTML]="it.html"></div>

            <div class="news-cta">
              <a class="cta-btn"
                 [routerLink]="['/actualites-expertise-immobiliere']"
                 [queryParams]="{ open: it.slug || it.id }">
                <span class="cta-label">Lire la suite</span>
                <span class="cta-plus" aria-hidden="true">
                  <svg viewBox="0 0 24 24" class="icon-plus"><path d="M12 5v14M5 12h14"/></svg>
                </span>
              </a>
            </div>
          </article>
        </div>

        <a
          class="news-side-btn"
          [routerLink]="['/actualites-expertise-immobiliere']"
          aria-label="Voir toutes les actualités"
        >
          Retrouvez nos derniers articles publiés ici
        </a>
      </div>
    </div>
  </section>
</div>
