<!-- src/app/pages/news/news.component.html -->
<div class="news-wrapper">
  <!-- ===== INTRO ===== -->
  <section class="section news-intro">
    <div class="section-inner pt-5 pt-lg-10">
      <h1 #introTitle class="page-title prehide">{{ intro.title }}</h1>

      <div class="intro-line">
        <p #introSubtitle class="page-subtitle prehide" [innerHTML]="intro.html"></p>

        <a
          *ngIf="intro.linkedinUrl as li"
          #introLinkedin
          class="linkedin prehide"
          [href]="li"
          target="_blank"
          rel="noopener"
          aria-label="Voir notre page LinkedIn"
        >
          <img
            src="assets/icons/linkedin.webp"
            alt=""
            aria-hidden="true"
            loading="lazy"
            decoding="async"
            fetchpriority="low"
          />
        </a>
      </div>
    </div>
  </section>

  <!-- ===== FILTRES THEMES (3 boutons côte à côte) ===== -->
  <div class="theme-filters px-0 py-5" role="group" aria-label="Filtrer les actualités par thème">
    <button
      *ngFor="let t of themeFilters"
      #themeFilterBtn
      class="theme-filter-btn prehide"
      type="button"
      [ngClass]="themeClass(t.key)"
      [attr.aria-pressed]="filterTheme === t.key"
      (click)="onFilter(t.key)"
    >
      {{ t.label }}
    </button>
  </div>

  <!-- ===== LISTE DES POSTS ===== -->
  <section class="section news-list" *ngIf="pagedPosts?.length">
    <div class="section-inner px-0 pt-5">
      <ul class="posts" role="list">
        <li
          #newsRow
          class="news-row"
          *ngFor="let p of pagedPosts; let i = index; trackBy: trackByIndex"
          [ngClass]="themeClass(p.themeKey)"
        >
          <div class="news-bg prehide-row" aria-hidden="true"></div>

          <div class="news-box prehide-row">
            <!-- Col texte -->
            <div class="news-col news-col--text">
              <!-- Thème: même logique + même style que les 3 boutons -->
              <button
                class="theme-filter-btn theme-chip"
                type="button"
                [ngClass]="themeClass(p.themeKey)"
                [attr.aria-pressed]="filterTheme === p.themeKey"
                (click)="onFilter(p.themeKey!)"
                title="Filtrer par ce thème"
              >
                {{ p.theme }}
              </button>

              <!-- Métadonnées -->
              <div class="meta-line">
                <img
                  class="firm-logo"
                  [appImgFast]="p?._firmLogoUrl || '/assets/fallbacks/logo-placeholder.svg'"
                  [placeholder]="'/assets/fallbacks/logo-placeholder.svg'"
                  alt=""
                  aria-hidden="true"
                  loading="lazy"
                  decoding="async"
                />

                <div class="meta-text d-flex flex-column">
                  <div class="firm-info">
                    <span class="firm-name" *ngIf="p.firmName">{{ p.firmName }}</span>
                    <span class="meta-sep" aria-hidden="true">—</span>
                  </div>

                  <div class="post-meta">
                    <span class="author-date" *ngIf="p.author || p.date">
                      {{ p.author }}<ng-container *ngIf="p.author && p.date">, </ng-container>{{ p.date }}
                    </span>
                  </div>
                </div>
              </div>

              <h2 class="post-title" *ngIf="p.title">{{ p.title }}</h2>

              <div class="post-excerpt" #excerptClip>
                <div
                  class="excerpt-body"
                  #excerptBody
                  [class.is-clamped]="!expanded[i]"
                  *ngIf="p.html"
                  [innerHTML]="p.html"
                ></div>
              </div>

              <div class="card-cta">
                <a
                  class="cta-btn"
                  [routerLink]="detailLink(p)"
                  [attr.aria-label]="'Lire la suite : ' + (p.title || '')"
                >
                  <span class="cta-label">Lire la suite</span>

                  <span class="cta-plus" aria-hidden="true">
                    <svg class="icon-plus" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                      <path d="M12 5v14M5 12h14"></path>
                    </svg>
                  </span>
                </a>

                <a
                  *ngIf="p.linkedinUrl"
                  [href]="p.linkedinUrl"
                  target="_blank"
                  rel="noopener"
                  class="card-linkedin"
                  aria-label="Lire sur LinkedIn"
                >
                  <img src="assets/icons/linkedin.webp" alt="" aria-hidden="true" />
                </a>
              </div>
            </div>

            <div class="news-col news-col--image">
              <div class="post-media">
                <img
                  class="post-media__img"
                  [appImgFast]="p?._imageUrl || '/assets/fallbacks/image-placeholder.svg'"
                  [placeholder]="'/assets/fallbacks/image-placeholder.svg'"
                  alt=""
                  loading="lazy"
                  decoding="async"
                />
              </div>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </section>

  <!-- ===== PAGER ===== -->
  <div #pagerWrapper class="pager-wrapper prehide-page" aria-live="polite">
    <nav #pager class="pager prehide-row" aria-label="Pagination des actualités">
      <div class="pager-slot pager-left">
        <button class="pager-btn" type="button" (click)="goPrev()" [disabled]="currentPage === 1">
          Précédent
        </button>
      </div>

      <div class="pager-slot pager-center">{{ currentPage }}/{{ totalPages }}</div>

      <div class="pager-slot pager-right">
        <button class="pager-btn" type="button" (click)="goNext()" [disabled]="currentPage === totalPages">
          Suivant
        </button>
      </div>
    </nav>
  </div>
</div>
