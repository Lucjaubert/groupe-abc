<div class="services-wrapper">

  <!-- ===== HERO ===== -->
  <section class="section hero" aria-labelledby="services-title">
    <div class="section-inner">
      <h1 #heroTitle id="services-title" class="page-title prehide">
        {{ pageTitle }}
      </h1>
    </div>
  </section>

  <!-- ===== CONTEXTES ===== -->
  <section class="section contexts" *ngIf="contexts?.length">
    <div class="section-inner px-0">
      <h3 #ctxTitle class="ctx-title prehide">{{ ctxIntro.title }}</h3>
      <div #ctxSub class="ctx-sub prehide" [innerHTML]="ctxIntro.html"></div>

      <ul #ctxList class="ctx-list prehide-row" role="list">
        <li
          #ctxRow
          class="ctx-row"
          *ngFor="let c of contexts; let i = index; trackBy: trackByIndex"
          [class.open]="ctxOpen[i]"
        >
          <div class="row-line">
            <img
              *ngIf="c.icon"
              class="ctx-icon"
              [src]="c.icon"
              (error)="onImgError($event)"
              alt=""
              loading="lazy"
              decoding="async"
            />

            <span class="row-name">{{ c.title }}</span>

            <button
              class="row-toggle"
              type="button"
              [attr.aria-expanded]="ctxOpen[i] ? 'true':'false'"
              (click)="toggleCtx(i)"
            >
              <svg class="chevron" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span class="sr-only">{{ ctxOpen[i] ? 'Réduire' : 'Déployer' }}</span>
            </button>
          </div>

          <div class="row-desc" *ngIf="c.html && ctxOpen[i]">
            <div class="row-desc-inner" [innerHTML]="c.html"></div>
          </div>
        </li>
      </ul>
    </div>
  </section>

  <!-- ===== CLIENTS ===== -->
  <section class="section clients" *ngIf="clients?.length">
    <div class="section-inner px-0">
      <h3 #clientsTitleEl class="clients-title prehide">{{ clientsTitle }}</h3>

      <ul #cliList class="cli-list prehide-row" role="list">
        <li
          #cliRow
          class="cli-row"
          *ngFor="let c of clients; let i = index; trackBy: trackByIndex"
          [class.open]="cliOpen[i]"
        >
          <div class="row-line">
            <div class="cli-name">{{ c.title }}</div>

            <button
              class="row-toggle"
              type="button"
              [attr.aria-expanded]="cliOpen[i] ? 'true':'false'"
              (click)="toggleCli(i)"
            >
              <svg class="chevron" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span class="sr-only">{{ cliOpen[i] ? 'Réduire' : 'Déployer' }}</span>
            </button>
          </div>

          <div class="row-desc" *ngIf="c.html && cliOpen[i]">
            <div class="row-desc-inner" [innerHTML]="c.html"></div>
          </div>
        </li>
      </ul>
    </div>
  </section>

  <!-- ===== RÉFÉRENCES ===== -->
  <section class="section refs" *ngIf="references?.length">
    <div class="section-inner">
      <h3 #refsTitleEl class="refs-title prehide">{{ refsTitle }}</h3>

      <ul #refsGrid class="refs-grid prehide-row" role="list">
        <li *ngFor="let logo of references; trackBy: trackByIndex">
          <img
            #refLogo
            class="prehide-row"
            [src]="logo"
            alt=""
            loading="lazy"
            decoding="async"
            (error)="onRefImgError($event)"
          />
        </li>
      </ul>
    </div>
  </section>

</div>
